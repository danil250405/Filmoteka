<!DOCTYPE html>
<html lang="ru en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Movie Library</title>



    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="../static/css/styleHome.css" rel="stylesheet" />
    <link rel="stylesheet" href="../../static/css/roots.css">
    <link rel="stylesheet" href="../../static/css/headersAndFootersStyle.css">


<!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">-->
    <script src="../static/js/homeJS.js"></script>
    <script>

    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>

<!--import header-->
<div th:replace="~{fragments/headerBase.html :: header}"></div>



<!--Film card-->
<div class="container my-5">
    <h2 class="mb-4 name-h2">Popular Movies</h2>
    <!--filter form-->
    <form th:action="@{/home-page}" th:class="filter-movies" method="post" class="row">
        <div class="form-group col-md-6">
            <label for="genre">Select Genre:</label>
            <select class="form-control" id="genre" name="genre">
                <option th:each="genre : ${genres}" th:value="${genre}" th:selected="${genre == selectedGenre}" th:text="${genre}"></option>
            </select>
        </div>
        <div class="form-group col-md-6">
            <label for="yearRange">Select Year Range:</label>
            <select class="form-control" id="yearRange" name="yearRange">
                <option th:each="range : ${yearRanges}" th:value="${range}" th:selected="${range == selectedYearRange}" th:text="${range}"></option>
            </select>
        </div>
        <div class="form-group col-md-12">
            <button type="submit" class="btn  btn-info  filter-btn">Submit</button>
        </div>
    </form>
    <div class="row">

        <div class="col-lg-12">

            <div class="row">
                <div class="col-md-3 mb-4" th:each="movie : ${movies}">

                    <div class="card">
                        <img th:src="${movie.previewUrlImg}" class="card-img-top" alt="Movie Poster">
                        <div class="card-body">
<!--                            <a th:href="@{/movie/page/id={id}(id=${movie.id})}">-->
<!--                             -->
<!--                            </a>-->

                            <a href="movie-page.html" th:href="@{|/movieId=${movie.id}|}">
                                <h5 class="card-title" th:text="${movie.name}">FilmName</h5>
                            </a>

                            <form th:action="@{/movie/details}" th:object="${movie}" method="post">
                                <input type="hidden" name="_method" value="get" />
                                <input type="hidden" name="id" th:value="${movie.id}" />
                                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal"
                                        th:attr="data-movie-name=${movie.name}, data-movie-description=${movie.description},
                                                 data-movie-img=${movie.previewUrlImg}, data-movie-ratingKp=${movie.imdbRating},
                                                 data-movie-ratingImdb=${movie.imdbRating}, data-movie-year=${movie.year}"
                                        onclick="setMovieData(
                                        this.getAttribute('data-movie-name'),
                                        this.getAttribute('data-movie-description'),
                                        this.getAttribute('data-movie-img'),
                                        this.getAttribute('data-movie-ratingKp'),
                                        this.getAttribute('data-movie-ratingImdb'),
                                        this.getAttribute('data-movie-year'))">Details</button>
                            </form>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!--pagination-->
    <nav th:if="${totalItems > 24}" aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <!-- Ссылка на предыдущую страницу -->
            <li th:class="${currentPage == 1} ? 'page-item disabled' : 'page-item'">
                <a th:href="@{${baseUrl + (currentPage - 1)}}" class="page-link" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Prev</span>
                </a>
            </li>

            <!-- Ссылка на первую страницу -->
            <li th:if="${currentPage >= 4}" th:class="${currentPage == 1} ? 'page-item active' : 'page-item'">
                <a th:href="@{${baseUrl + 1}}" class="page-link">1</a>
            </li>

            <!-- Ссылка на страницу "..." -->
            <li th:if="${currentPage > 4}" class="page-item disabled">
                <a href="#" class="page-link">...</a>
            </li>

            <!-- Ссылки на страницы в диапазоне currentPage +/- 2 -->
            <li th:each="pageNum : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 1, currentPage < totalPages - 2 ? currentPage + 2 : totalPages)}"
                th:class="${pageNum == currentPage} ? 'page-item active' : 'page-item'">
                <a th:href="@{${baseUrl + pageNum}}" class="page-link" th:text="${pageNum}"></a>
            </li>

            <!-- Ссылка на страницу "..." -->
            <li th:if="${currentPage < totalPages - 3} " class="page-item disabled">
                <a href="#" class="page-link">...</a>
            </li>

            <!-- Ссылка на последнюю страницу -->
            <li th:if="${currentPage < totalPages - 2}" th:class="${currentPage == totalPages} ? 'page-item active' : 'page-item'">
                <a th:href="@{${baseUrl + totalPages}}" class="page-link" th:text="${totalPages}"></a>
            </li>

            <!-- Ссылка на следующую страницу -->
            <li th:class="${currentPage == totalPages} ? 'page-item disabled' : 'page-item'">
                <a th:href="@{${baseUrl + (currentPage + 1)}}" class="page-link" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

<!-- Modal -->

<div class="container">

    <!-- Trigger the modal with a button -->

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body">
                    <h5 class="card-title film-title">Film Name</h5>
                    <img class="card-img-top film-img" src="#" alt="Film Image">
                    <p class="film-description"></p>
                    <p>IMDb Rating: <span class="rating-imdb"></span></p>
                    <p>Kinopoisk Rating: <span class="rating-kp"></span></p>
                    <p>Year: <span class="year"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</div>




<footer class="bg-dark text-white">
    <div class="container">
        <p class="mb-0" >&copy; Filmoteka 2024</p>
    </div>
</footer>

</body>
</html>
